<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Ingeniería en Recursos Hídricos</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: #f4f7f8;
  margin: 0;
  padding: 20px;
}

h1 {
  text-align: center;
}

.malla {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 10px;
}

.semestre {
  background: #ffffff;
  border-radius: 10px;
  padding: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.semestre h2 {
  font-size: 14px;
  text-align: center;
  margin-bottom: 8px;
}

.curso {
  background: #dfeff1;
  border-radius: 8px;
  padding: 6px;
  margin-bottom: 6px;
  font-size: 12px;
  cursor: pointer;
  position: relative;
}

.curso.aprobado {
  background: #b7e4c7;
  text-decoration: line-through;
}

.curso.bloqueado {
  background: #e0e0e0;
  color: #777;
  cursor: not-allowed;
}

.curso.bloqueado:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  background: #333;
  color: #fff;
  font-size: 11px;
  padding: 5px;
  border-radius: 6px;
  top: 100%;
  left: 0;
  white-space: pre-line;
  z-index: 10;
}
</style>
</head>
<body>

<h1>Malla Curricular – Ingeniería en Recursos Hídricos</h1>

<div class="malla" id="malla"></div>

<script>
const cursos = [
  // ===== PRIMER AÑO =====
  {id:"calculo1", nombre:"Cálculo I", sem:1, req:[]},
  {id:"algebra", nombre:"Álgebra y Geometría", sem:1, req:[]},
  {id:"quimica", nombre:"Química General", sem:1, req:[]},
  {id:"prog1", nombre:"Programación I", sem:1, req:[]},
  {id:"intro_hidro", nombre:"Introducción a la Hidrología", sem:1, req:[]},
  {id:"ingles1", nombre:"Inglés I", sem:1, req:[]},

  {id:"calculo2", nombre:"Cálculo II", sem:2, req:["calculo1"]},
  {id:"algebra_lineal", nombre:"Álgebra Lineal", sem:2, req:["algebra"]},
  {id:"geologia", nombre:"Geología y Geomorfología", sem:2, req:[]},
  {id:"fisica", nombre:"Física General", sem:2, req:["calculo1"]},
  {id:"socio_general", nombre:"Sociología General", sem:2, req:[]},
  {id:"ingles2", nombre:"Inglés II", sem:2, req:["ingles1"]},

  // ===== SEGUNDO AÑO =====
  {id:"calculo3", nombre:"Cálculo III", sem:3, req:["calculo2"]},
  {id:"ed", nombre:"Ecuaciones Diferenciales", sem:3, req:["algebra_lineal","calculo2"]},
  {id:"eco_general", nombre:"Ecología General", sem:3, req:["quimica"]},
  {id:"termo", nombre:"Termodinámica", sem:3, req:["fisica","quimica"]},
  {id:"socio_rural", nombre:"Sociología Rural", sem:3, req:["socio_general"]},
  {id:"ingles3", nombre:"Inglés III", sem:3, req:["ingles2"]},

  {id:"mf", nombre:"Mecánica de Fluidos e Hidráulica Fluvial", sem:4, req:["ed","fisica"]},
  {id:"prob", nombre:"Probabilidades y Estadística", sem:4, req:["calculo2","algebra_lineal"]},
  {id:"clima", nombre:"Climatología", sem:4, req:["termo"]},
  {id:"prog2", nombre:"Programación II", sem:4, req:["prog1"]},
  {id:"agua_soc", nombre:"Agua y Sociedad", sem:4, req:["socio_rural"]},
  {id:"ingles4", nombre:"Inglés IV", sem:4, req:["ingles3"]},

  // ===== TERCER AÑO =====
  {id:"micro", nombre:"Micro y Macroeconomía", sem:5, req:["calculo3"]},
  {id:"estad_ap", nombre:"Estadística Aplicada", sem:5, req:["prob","calculo3"]},
  {id:"suelo", nombre:"Ciencias del Suelo", sem:5, req:["quimica","geologia"]},
  {id:"isva", nombre:"Interacción Suelo–Vegetación–Atmósfera", sem:5, req:["clima"]},
  {id:"cc", nombre:"Componentes de Cambio Climático", sem:5, req:["socio_rural"]},

  {id:"finanzas", nombre:"Finanzas y Administración", sem:6, req:["micro"]},
  {id:"opt", nombre:"Optimización del Uso de RRHH", sem:6, req:["calculo3","ed"]},
  {id:"calidad", nombre:"Calidad del Agua", sem:6, req:["mf","quimica"]},
  {id:"geomatica", nombre:"Geomática y Análisis Espacial", sem:6, req:["prog2","algebra_lineal"]},
  {id:"hidro_sup", nombre:"Hidrología Superficial", sem:6, req:["estad_ap","mf"]},

  // ===== CUARTO AÑO =====
  {id:"herr", nombre:"Herramientas de Análisis Económico y Social", sem:7, req:["agua_soc","finanzas"]},
  {id:"eco_acu", nombre:"Ecología de Sistemas Acuáticos", sem:7, req:["eco_general"]},
  {id:"hidro_sub", nombre:"Hidrología Subterránea", sem:7, req:["suelo","hidro_sup"]},
  {id:"erosion", nombre:"Control de Procesos Erosivos", sem:7, req:["hidro_sup"]},
  {id:"conflicto", nombre:"Conflicto y Desarrollo Comunitario", sem:7, req:["agua_soc"]},

  {id:"eval_proj", nombre:"Evaluación de Proyectos", sem:8, req:["finanzas"]},
  {id:"eia", nombre:"Evaluación de Impacto Ambiental", sem:8, req:["eco_acu"]},
  {id:"modelacion", nombre:"Modelación Hidrológica", sem:8, req:["estad_ap"]},
  {id:"rest", nombre:"Restauración Hidrológica de Cuencas", sem:8, req:["erosion"]},
  {id:"valor", nombre:"Valoración de Servicios Ecosistémicos", sem:8, req:["herr","agua_soc"]},

  // ===== QUINTO AÑO =====
  {id:"politica", nombre:"Política y Legislación del Agua", sem:9, req:["agua_soc"]},
  {id:"socio_hidro", nombre:"Estudios Socio-Hidrológicos", sem:9, req:["herr","valor"]},
  {id:"girh", nombre:"Gestión Integrada de RRHH", sem:9, req:["conflicto","modelacion","opt"]},
  {id:"taller", nombre:"Taller de Memoria de Título", sem:9, req:["practica4"]},

  {id:"memoria", nombre:"Memoria de Título", sem:10, req:["taller"]},
];

// ===== LÓGICA =====
const estado = JSON.parse(localStorage.getItem("estadoMalla")) || {};

function render() {
  const cont = document.getElementById("malla");
  cont.innerHTML = "";

  for (let s = 1; s <= 10; s++) {
    const col = document.createElement("div");
    col.className = "semestre";
    col.innerHTML = `<h2>Semestre ${s}</h2>`;

    cursos.filter(c => c.sem === s).forEach(c => {
      const div = document.createElement("div");
      div.className = "curso";
      div.textContent = c.nombre;

      const aprobados = c.req.every(r => estado[r]);

      if (estado[c.id]) div.classList.add("aprobado");
      else if (!aprobados) {
        div.classList.add("bloqueado");
        div.dataset.tooltip = "Falta aprobar:\n" + c.req.filter(r => !estado[r]).join(", ");
      }

      div.onclick = () => {
        if (!div.classList.contains("bloqueado")) {
          estado[c.id] = !estado[c.id];
          localStorage.setItem("estadoMalla", JSON.stringify(estado));
          render();
        }
      };

      col.appendChild(div);
    });

    cont.appendChild(col);
  }
}

render();
</script>

</body>
</html>
