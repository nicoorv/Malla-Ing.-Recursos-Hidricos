<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Ingenier√≠a en Recursos H√≠dricos</title>

<style>
:root{
  --bg:#eef3f8;
  --card:#ffffff;
  --curso:#dbe7f2;
  --aprobado:#b6d7f2;
  --plan:#c7d8ea;
  --bloqueado:#e4e9ef;
  --texto:#1e2a36;
  --accent:#5a86ad;
}
body.dark{
  --bg:#0f1720;
  --card:#18222d;
  --curso:#223040;
  --aprobado:#2f5f8a;
  --plan:#355d82;
  --bloqueado:#2a3440;
  --texto:#e6edf3;
  --accent:#7aa7d8;
}
body{
  font-family:"Segoe UI",sans-serif;
  background:var(--bg);
  color:var(--texto);
  padding:20px;
}
h1{text-align:center}
.panel{
  max-width:1200px;
  margin:0 auto 20px;
  background:var(--card);
  padding:15px;
  border-radius:14px;
}
.barra{
  height:14px;
  background:#cdd8e3;
  border-radius:8px;
  overflow:hidden;
}
.barra div{
  height:100%;
  background:var(--accent);
}
.controles{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:space-between;
}
button{
  background:var(--accent);
  color:white;
  border:none;
  border-radius:8px;
  padding:6px 10px;
  cursor:pointer;
}
.malla{
  display:grid;
  grid-template-columns:repeat(10,1fr);
  gap:14px;
}
.anio{
  grid-column:span 2;
  text-align:center;
  font-weight:bold;
  color:var(--accent);
}
.sem h3{
  background:var(--accent);
  color:white;
  border-radius:8px;
  text-align:center;
  cursor:pointer;
  font-size:13px;
  padding:4px;
}
.curso{
  background:var(--curso);
  border-radius:10px;
  padding:6px;
  font-size:12px;
  margin-top:6px;
  cursor:pointer;
}
.aprobado{
  background:var(--aprobado);
  text-decoration:line-through;
}
.plan{
  outline:2px dashed var(--accent);
}
.bloqueado{
  background:var(--bloqueado);
  color:#7a8a9a;
  cursor:not-allowed;
}
.bloqueado:hover::after{
  content:attr(data-tooltip);
  position:absolute;
  background:#111;
  color:white;
  padding:6px;
  font-size:11px;
  border-radius:8px;
  white-space:pre-line;
}

/* Pantalla introductoria */
#intro{
  position:fixed;
  inset:0;
  background:linear-gradient(
    135deg,
    #dbe7f2,
    #eef3f8,
    #c7d8ea
  );
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
  cursor:pointer;
}

body.dark #intro{
  background:linear-gradient(
    135deg,
    #0f1720,
    #18222d,
    #223040
  );
}

.intro-box{
  background:rgba(255,255,255,0.85);
  border-radius:18px;
  padding:25px 30px;
  text-align:center;
  max-width:420px;
}

body.dark .intro-box{
  background:rgba(24,34,45,0.85);
}

.intro-box img{
  width:160px;
  margin-bottom:10px;
}

.intro-box h2{
  margin:10px 0;
  color:var(--accent);
}

.intro-box p{
  font-size:14px;
  line-height:1.4;
}

  .curso{
  transition:
    transform 0.15s ease,
    box-shadow 0.15s ease;
}

.curso:active{
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.12);
}

  
</style>
</head>

<body>

  <!-- Pantalla de bienvenida -->
<div id="intro" onclick="this.style.display='none'">
  <div class="intro-box">
    <img src="spheal.png" alt="Spheal">
    <h2>Bienvenido a tu malla interactiva</h2>
    <p>
      Aqu√≠ puedes marcar tus ramos aprobados y ver c√≥mo se van
      desbloqueando los siguientes seg√∫n los prerrequisitos!!
    </p>
    <p><strong>Haz click para comenzar</strong></p>
  </div>
</div>


<h1>Malla Ingenier√≠a en Recursos H√≠dricos</h1>

<div class="panel">
  <div id="creditos"></div>
  <div class="barra"><div id="prog"></div></div>

  <div class="controles">
    <label><input type="checkbox" id="modoPlan"> Modo planificaci√≥n</label>
    <label><input type="checkbox" id="modoOscuro"> Modo oscuro</label>
  </div>

  <hr>

  <strong>Pr√°cticas</strong><br>
  <label><input type="checkbox" onchange="togglePractica(1)"> Pr√°ctica I</label>
  <label><input type="checkbox" onchange="togglePractica(2)"> Pr√°ctica II</label>
  <label><input type="checkbox" onchange="togglePractica(3)"> Pr√°ctica III</label>
  <label><input type="checkbox" onchange="togglePractica(4)"> Pr√°ctica IV</label>

  <hr>

<strong>Extras</strong><br>

<label>
  <input type="checkbox" onchange="toggleExtra('cfg1')"> CFG I (2 cr√©ditos)
</label>
<label>
  <input type="checkbox" onchange="toggleExtra('cfg2')"> CFG II (2 cr√©ditos)
</label>
<label>
  <input type="checkbox" onchange="toggleExtra('cfg3')"> CFG III (2 cr√©ditos)
</label>

<br><br>

<label>
  <input type="checkbox" onchange="toggleExtra('esp1')"> Electivo Especializado I (3 cr√©ditos)
</label>
<label>
  <input type="checkbox" onchange="toggleExtra('esp2')"> Electivo Especializado II (3 cr√©ditos)
</label>
<label>
  <input type="checkbox" onchange="toggleExtra('esp3')"> Electivo Especializado III (3 cr√©ditos)
</label>

<br><br>

<label>
  <input type="checkbox" onchange="toggleExtra('comp1')"> Electivo Complementario I (1 cr√©dito)
</label>
<label>
  <input type="checkbox" onchange="toggleExtra('comp2')"> Electivo Complementario II (1 cr√©dito)
</label>

</div>

<div class="malla" id="malla"></div>

<script>
const TOTAL=300;
  
const CREDITOS_PRACTICAS = {
  practica1: 4,
  practica2: 4,
  practica3: 4,
  practica4: 8
};

const CREDITOS_EXTRAS = {
  cfg1: 2,
  cfg2: 2,
  cfg3: 2,
  esp1: 3,
  esp2: 3,
  esp3: 3,
  comp1: 1,
  comp2: 1
};

  
const cursos=[
  {id:"calculo1",n:"C√°lculo I",c:6,sem:1,r:[]},
  {id:"algebra_geom",n:"√Ålgebra y Geometr√≠a",c:6,sem:1,r:[]},
  {id:"quimica",n:"Qu√≠mica General",c:5,sem:1,r:[]},
  {id:"prog1",n:"Programaci√≥n I",c:5,sem:1,r:[]},
  {id:"intro_hidro",n:"Introducci√≥n a la Hidrolog√≠a",c:4,sem:1,r:[]},
  {id:"ingles1",n:"Ingl√©s I",c:2,sem:1,r:[]},

  {id:"calculo2",n:"C√°lculo II",c:6,sem:2,r:["calculo1"]},
  {id:"algebra_lin",n:"√Ålgebra Lineal",c:6,sem:2,r:["algebra_geom"]},
  {id:"geologia",n:"Geolog√≠a y Geomorfolog√≠a",c:5,sem:2,r:[]},
  {id:"fisica",n:"F√≠sica General",c:5,sem:2,r:["calculo1"]},
  {id:"socio_gen",n:"Sociolog√≠a General",c:4,sem:2,r:[]},
  {id:"ingles2",n:"Ingl√©s II",c:2,sem:2,r:["ingles1"]},

  {id:"calculo3",n:"C√°lculo III",c:6,sem:3,r:["calculo2"]},
  {id:"ed",n:"Ecuaciones Diferenciales",c:5,sem:3,r:["algebra_lin","calculo2"]},
  {id:"eco_gen",n:"Ecolog√≠a General",c:5,sem:3,r:["quimica"]},
  {id:"termo",n:"Termodin√°mica",c:5,sem:3,r:["fisica","quimica"]},
  {id:"socio_rural",n:"Sociolog√≠a Rural",c:5,sem:3,r:["socio_gen"]},
  {id:"ingles3",n:"Ingl√©s III",c:2,sem:3,r:["ingles2"]},

  {id:"mf",n:"Mec√°nica de Fluidos",c:6,sem:4,r:["ed","fisica"]},
  {id:"prob",n:"Probabilidades y Estad√≠stica",c:5,sem:4,r:["calculo2","algebra_lin"]},
  {id:"clima",n:"Climatolog√≠a",c:5,sem:4,r:["termo"]},
  {id:"prog2",n:"Programaci√≥n II",c:5,sem:4,r:["prog1"]},
  {id:"agua_soc",n:"Agua y Sociedad",c:5,sem:4,r:["socio_rural"]},
  {id:"ingles4",n:"Ingl√©s IV",c:2,sem:4,r:["ingles3"]},

  {id:"micro",n:"Micro y Macroeconom√≠a",c:5,sem:5,r:["calculo3"]},
  {id:"estad_ap",n:"Estad√≠stica Aplicada",c:5,sem:5,r:["prob","calculo3"]},
  {id:"suelo",n:"Ciencias del Suelo",c:6,sem:5,r:["quimica","geologia"]},
  {id:"isva",n:"Interacci√≥n Suelo‚ÄìVegetaci√≥n‚ÄìAtm√≥sfera",c:6,sem:5,r:["clima"]},
  {id:"cc",n:"Componentes de Cambio Clim√°tico",c:4,sem:5,r:["socio_rural"]},

  {id:"finanzas",n:"Finanzas y Administraci√≥n",c:5,sem:6,r:["micro"]},
  {id:"opt",n:"Optimizaci√≥n del Uso del Recurso H√≠drico",c:4,sem:6,r:["calculo3","ed"]},
  {id:"calidad",n:"Calidad del Agua",c:5,sem:6,r:["mf","quimica"]},
  {id:"geomatica",n:"Geom√°tica y An√°lisis Espacial",c:5,sem:6,r:["prog2","algebra_lin"]},
  {id:"hidro_sup",n:"Hidrolog√≠a Superficial",c:6,sem:6,r:["estad_ap","mf"]},

  {id:"herr",n:"Herramientas de An√°lisis Econ√≥mico y Social",c:4,sem:7,r:["agua_soc","finanzas"]},
  {id:"eco_acu",n:"Ecolog√≠a de Sistemas Acu√°ticos",c:4,sem:7,r:["eco_gen"]},
  {id:"hidro_sub",n:"Hidrolog√≠a Subterr√°nea",c:6,sem:7,r:["suelo","hidro_sup"]},
  {id:"erosion",n:"Evaluaci√≥n y Control de Procesos Erosivos",c:4,sem:7,r:["hidro_sup"]},
  {id:"conflicto",n:"Conflicto y Desarrollo Comunitario de Cuencas",c:5,sem:7,r:["agua_soc"]},

  {id:"eval_proj",n:"Evaluaci√≥n de Proyectos",c:4,sem:8,r:["finanzas"]},
  {id:"eia",n:"Evaluaci√≥n de Impacto Ambiental",c:4,sem:8,r:["eco_acu"]},
  {id:"modelacion",n:"Modelaci√≥n Hidrol√≥gica",c:5,sem:8,r:["estad_ap"]},
  {id:"rest",n:"Restauraci√≥n Hidrol√≥gica de Cuencas",c:5,sem:8,r:["erosion"]},
  {id:"valor",n:"Valoraci√≥n de Servicios Ecosist√©micos",c:5,sem:8,r:["herr","agua_soc"]},

  {id:"politica",n:"Pol√≠tica y Legislaci√≥n del Agua",c:6,sem:9,r:["agua_soc"]},
  {id:"socio_hidro",n:"Estudios Socio-Hidrol√≥gicos",c:6,sem:9,r:["herr","valor"]},
  {id:"girh",n:"Gesti√≥n Integrada de Recursos H√≠dricos",c:6,sem:9,r:["conflicto","modelacion","opt"]},
  {id:"taller", n:"Taller de Memoria de T√≠tulo", c:6, sem:9, r:[]},

  {id:"memoria",n:"Memoria de T√≠tulo",c:30,sem:10,r:["taller"]}
];

let estado = JSON.parse(localStorage.getItem("estado")) || {};
let plan = {};
let practicas = JSON.parse(localStorage.getItem("practicas")) || {};
let extras = JSON.parse(localStorage.getItem("extras")) || {};
let modoPlan = false;

function creditos(){
  let total = cursos.reduce(
    (t, c) => estado[c.id] ? t + c.c : t, 0
  );

  // pr√°cticas
  for(const p in CREDITOS_PRACTICAS){
    if(practicas[p]) total += CREDITOS_PRACTICAS[p];
  }

  // extras
  for(const e in CREDITOS_EXTRAS){
    if(extras[e]) total += CREDITOS_EXTRAS[e];
  }

  return total;
}


function togglePractica(n){
  practicas["practica"+n] = !practicas["practica"+n];
  localStorage.setItem("practicas", JSON.stringify(practicas));
  render();
}

function toggleExtra(id){
  extras[id] = !extras[id];
  localStorage.setItem("extras", JSON.stringify(extras));
  render();
}
  
function guardar(){
  localStorage.setItem("estado",JSON.stringify(estado));
  render();
}

function marcarSemestre(s){
  const delSem = cursos.filter(c => c.sem === s);

  const todosAprobados = delSem.every(c => estado[c.id]);

  delSem.forEach(c => {
    if (modoPlan) {
      plan[c.id] = !todosAprobados;
    } else {
      estado[c.id] = !todosAprobados;
    }
  });

  guardar();
}


function render(){
const pct = Math.min(100, Math.round(creditos() / TOTAL * 100));

document.getElementById("creditos").textContent =
  `Cr√©ditos aprobados: ${creditos()} / ${TOTAL} (${pct}%)`;
  document.getElementById("prog").style.width =
    (creditos()/TOTAL*100) + "%";

  const cont = document.getElementById("malla");
  cont.innerHTML = "";

  // A√ëOS
  for(let a=1; a<=5; a++){
    const h = document.createElement("div");
    h.className = "anio";
    h.textContent = `A√±o ${a}`;
    cont.appendChild(h);
  }

  // SEMESTRES
  for(let s=1; s<=10; s++){
    const col = document.createElement("div");
    col.className = "sem";
    col.innerHTML = `<h3 onclick="marcarSemestre(${s})">Semestre ${s}</h3>`;

    cursos.filter(c=>c.sem===s).forEach(c=>{
      const d = document.createElement("div");
      d.className = "curso";
      d.textContent = c.n;

      let faltan = c.r.filter(r =>
  !(estado[r] || (modoPlan && plan[r]))
);


if (c.id === "taller" && !practicas.practica4) {
  faltan = ["practica4"];
}

/* ESTADO VISUAL */
if (estado[c.id]) {
  d.classList.add("aprobado");

} else if (modoPlan && plan[c.id]) {
  d.classList.add("plan");

} else if (faltan.length) {
  d.classList.add("bloqueado");

  const nombres = faltan.map(x => {
    if (x.startsWith("practica")) return "Pr√°ctica IV";
    const curso = cursos.find(y => y.id === x);
    return curso ? curso.n : x;
  });

  d.dataset.tooltip =
    "Falta aprobar:\n- " + nombres.join("\n- ");
}

/* CLICK */
d.onclick = () => {
  if (d.classList.contains("bloqueado")) return;

  if (modoPlan) {
    plan[c.id] = !plan[c.id];
  } else {
    estado[c.id] = !estado[c.id];
  }

  render();
};
      col.appendChild(d);
    });

    cont.appendChild(col);
  }

  // üîπ SINCRONIZACI√ìN (VA AQU√ç, FUERA DE LOS FOR)
  for(let i=1;i<=4;i++){
    const cb = document.querySelector(
      `input[onchange="togglePractica(${i})"]`
    );
    if(cb) cb.checked = !!practicas["practica"+i];
  }

  Object.keys(CREDITOS_EXTRAS).forEach(id=>{
    const cb = document.querySelector(
      `input[onchange="toggleExtra('${id}')"]`
    );
    if(cb) cb.checked = !!extras[id];
  });
}

document.getElementById("modoPlan").onchange=e=>{
  modoPlan=e.target.checked;
  plan={};
  render();
};
document.getElementById("modoOscuro").onchange=e=>{
  document.body.classList.toggle("dark",e.target.checked);
};

render();
</script>
</body>
</html>
